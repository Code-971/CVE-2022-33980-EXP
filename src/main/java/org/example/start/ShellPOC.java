package org.example.start;

import org.apache.commons.configuration2.interpol.ConfigurationInterpolator;
import org.apache.commons.configuration2.interpol.InterpolatorSpecification;
import org.springframework.web.bind.annotation.*;

@RestController
public class ShellPOC {

    @RequestMapping(value = "/vul", method = RequestMethod.GET)
    @ResponseBody
    public String vul(@RequestParam(defaultValue = "ConfigurationShell") String payload) {
        InterpolatorSpecification spec = new InterpolatorSpecification.Builder()
                .withPrefixLookups(ConfigurationInterpolator.getDefaultPrefixLookups())
                .withDefaultLookups(ConfigurationInterpolator.getDefaultPrefixLookups().values())
                .create();

        ConfigurationInterpolator interpolator = ConfigurationInterpolator.fromSpecification(spec);
        try {
              interpolator.interpolate(payload);
        } catch (Exception e) {
            System.out.println(e);
        }
        return "Payload:" + payload +
                "<br>" +
                "Response:" +interpolator.interpolate(payload).toString();
    }
}